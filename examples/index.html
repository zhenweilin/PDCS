<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
   <link rel="stylesheet" href="/PDCS/libs/katex/katex.min.css">
     
   <link rel="stylesheet" href="/PDCS/libs/highlight/styles/github.min.css">
   
  <link rel="stylesheet" href="/PDCS/css/franklin.css">
  <link rel="stylesheet" href="/PDCS/css/basic.css">
  <link rel="icon" href="/PDCS/PDCS/assets/pdcs_icon.png">
   <title>Examples</title>  
</head>
<body>
  <header>
<div class="blog-name"><a href="/PDCS/">PDCS</a></div>
<nav>
  <ul>
    <li><a href="/PDCS/">Home</a></li>
    <li><a href="/PDCS/examples">Examples</a></li>
    <li><a href="/PDCS/parameters">Parameters</a></li>
    <li><a href="/PDCS/algorithms">Algorithm</a></li>
  </ul>
  <img src="/PDCS/assets/hamburger.svg" id="menu-icon">
</nav>
</header>


<!-- Content appended here -->
<div class="franklin-content">
<h1 id="examples"><a href="#examples" class="header-anchor">Examples</a></h1>
<div class="franklin-toc"><ol><li><a href="#exponential_cone_examples">exponential cone examples</a><ol><li><a href="#fisher_market_equilibrium">Fisher market equilibrium</a></li></ol></li></ol></div>
<p>Here, we give some examples about using pdcs api. </p>
<h3 id="exponential_cone_examples"><a href="#exponential_cone_examples" class="header-anchor">exponential cone examples</a></h3>
<h5 id="fisher_market_equilibrium"><a href="#fisher_market_equilibrium" class="header-anchor">Fisher market equilibrium</a></h5>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>m</mi><mi>i</mi><msub><mi>n</mi><mrow><mi mathvariant="bold">X</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>m</mi><mo>×</mo><mi>n</mi></mrow></msup></mrow></msub><mo>−</mo><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow></munder><msub><mi>w</mi><mi>i</mi></msub><mrow><mo fence="true">(</mo><mi>log</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><munder><mo>∑</mo><mrow><mi>j</mi><mo>∈</mo><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo></mrow></munder><msub><mi mathvariant="bold">U</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi mathvariant="bold">X</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mtext>s.t.</mtext><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow></munder><msub><mi mathvariant="bold">X</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>b</mi><mi>j</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">X</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">
min_{\mathbf{X}\in\mathbb{R}^{m\times n}} - \sum_{i\in[m]} w_i \left( \log \left( \sum_{j\in[n]}\mathbf{U}_{ij}\mathbf{X}_{ij}\right) \right) \text{s.t.} \sum_{i\in[m]}\mathbf{X}_{ij}=b_j, \mathbf{X}_{ij}\geq 0
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8369em;vertical-align:-0.1774em;"></span><span class="mord mathnormal">mi</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3419em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">X</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathbb mtight">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7027em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1774em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.809em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">m</span><span class="mclose mtight">]</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.516em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-2.25em;"><span class="pstrut" style="height:3.155em;"></span><span class="delimsizinginner delim-size4"><span>⎝</span></span></span><span style="top:-3.397em;"><span class="pstrut" style="height:3.155em;"></span><span style="height:0.016em;width:0.875em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.875em' height='0.016em' style='width:0.875em' viewBox='0 0 875 16' preserveAspectRatio='xMinYMin'><path d='M291 0 H417 V16 H291z M291 0 H417 V16 H291z'/></svg></span></span><span style="top:-4.05em;"><span class="pstrut" style="height:3.155em;"></span><span class="delimsizinginner delim-size4"><span>⎛</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-2.25em;"><span class="pstrut" style="height:3.155em;"></span><span class="delimsizinginner delim-size4"><span>⎝</span></span></span><span style="top:-3.397em;"><span class="pstrut" style="height:3.155em;"></span><span style="height:0.016em;width:0.875em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.875em' height='0.016em' style='width:0.875em' viewBox='0 0 875 16' preserveAspectRatio='xMinYMin'><path d='M291 0 H417 V16 H291z M291 0 H417 V16 H291z'/></svg></span></span><span style="top:-4.05em;"><span class="pstrut" style="height:3.155em;"></span><span class="delimsizinginner delim-size4"><span>⎛</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.809em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">∈</span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">n</span><span class="mclose mtight">]</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.516em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-2.25em;"><span class="pstrut" style="height:3.155em;"></span><span class="delimsizinginner delim-size4"><span>⎠</span></span></span><span style="top:-3.397em;"><span class="pstrut" style="height:3.155em;"></span><span style="height:0.016em;width:0.875em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.875em' height='0.016em' style='width:0.875em' viewBox='0 0 875 16' preserveAspectRatio='xMinYMin'><path d='M457 0 H583 V16 H457z M457 0 H583 V16 H457z'/></svg></span></span><span style="top:-4.05em;"><span class="pstrut" style="height:3.155em;"></span><span class="delimsizinginner delim-size4"><span>⎞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-2.25em;"><span class="pstrut" style="height:3.155em;"></span><span class="delimsizinginner delim-size4"><span>⎠</span></span></span><span style="top:-3.397em;"><span class="pstrut" style="height:3.155em;"></span><span style="height:0.016em;width:0.875em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.875em' height='0.016em' style='width:0.875em' viewBox='0 0 875 16' preserveAspectRatio='xMinYMin'><path d='M457 0 H583 V16 H457z M457 0 H583 V16 H457z'/></svg></span></span><span style="top:-4.05em;"><span class="pstrut" style="height:3.155em;"></span><span class="delimsizinginner delim-size4"><span>⎞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">s.t.</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.809em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">∈</span><span class="mopen mtight">[</span><span class="mord mathnormal mtight">m</span><span class="mclose mtight">]</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.516em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span>
<pre><code class="language-julia">using LinearAlgebra
using SparseArrays
using Random
using SparseArrays
include&#40;&quot;PDCS_GPU.jl&quot;&#41;
m &#61; 100
n &#61; 300
rng &#61; Random.MersenneTwister&#40;1&#41;
w &#61; rand&#40;rng, m&#41;
u &#61; rand&#40;rng, m * n&#41;
u .&#61; abs.&#40;u&#41;
u&#91;rand&#40;rng, m * n&#41; .&lt; 0.8&#93; .&#61; 0.0
u &#61; reshape&#40;u, m, n&#41;
sparse_u &#61; sparse&#40;u&#41;
nnz_u &#61; nnz&#40;sparse_u&#41;
println&#40;nnz_u&#41;
btilde &#61; 0.25*m*ones&#40;n&#41;

m, n &#61; size&#40;u&#41;
b &#61; zeros&#40;m &#43; n &#43; 3m&#41;
b&#91;1:n&#93; .&#61; btilde
for i in 1:m
    b&#91;n &#43; m &#43; 3&#40;i - 1&#41; &#43; 2&#93; &#61; -1.0
end
u &#61; vec&#40;u&#39;&#41;
sparse_u &#61; sparse&#40;u&#41;
nnz_u &#61; nnz&#40;sparse_u&#41;
println&#40;nnz_u&#41;
row_indices &#61; zeros&#40;Int, nnz_u&#41;
for i &#61; 1:nnz_u
    row_indices&#91;i&#93; &#61; &#40;sparse_u.nzind&#91;i&#93; - 1&#41; ÷ n &#43; 1 &#43; n
end

c &#61; zeros&#40;m*n &#43; 2*m&#41;
@views c&#91;m*n&#43;1:2:m*n&#43;2*m-1&#93; .&#61; -w
rows &#61; repeat&#40;1:n, m&#41;
cols &#61; repeat&#40;&#40;0:&#40;m-1&#41;&#41; * n, inner&#61;n&#41; .&#43; repeat&#40;1:n, m&#41;
values &#61; ones&#40;n * m&#41;
row2 &#61; row_indices
col2 &#61; sparse_u.nzind
val2 &#61; sparse_u.nzval
row &#61; vcat&#40;&#91;rows, row2&#93;...&#41;
col &#61; vcat&#40;&#91;cols, col2&#93;...&#41;
val &#61; vcat&#40;&#91;values, val2&#93;...&#41;
row3 &#61; &#40;n&#43;1&#41; : &#40;n&#43;m&#41;
col3 &#61; m * n .&#43; 2 .* &#40;1:m&#41;  
val3 &#61; fill&#40;-1.0, m&#41;

row &#61; vcat&#40;&#91;row, row3&#93;...&#41;
col &#61; vcat&#40;&#91;col, col3&#93;...&#41;
val &#61; vcat&#40;&#91;val, val3&#93;...&#41;

row4 &#61; vcat&#40;&#91;&#91;3*i &#43; 1, 3i&#43;3&#93; for i in 0:&#40;m-1&#41;&#93;...&#41; .&#43; &#40;m &#43; n&#41;
col4 &#61; Vector&#123;Integer&#125;&#40;1:2m&#41;
col4 &#61; col4 .&#43; &#40;m * n&#41;
val4 &#61; fill&#40;1.0, 2m&#41;
row &#61; vcat&#40;&#91;row, row4&#93;...&#41;
col &#61; vcat&#40;&#91;col, col4&#93;...&#41;
val &#61; vcat&#40;&#91;val, val4&#93;...&#41;
A &#61; sparse&#40;row, col, val, m &#43; n &#43; 3m, m*n &#43; m &#43; m&#41;
mA, nA &#61; size&#40;A&#41;
bl &#61; fill&#40;0.0, nA&#41;
bl&#91;m*n&#43;1:m*n&#43;2*m&#93; .&#61; -Inf
bu &#61; fill&#40;Inf, nA&#41;
# expG &#61; Vector&#123;Integer&#125;&#40;ones&#40;m&#41; * 3&#41;
sol_res &#61; PDCS_GPU.rpdhg_gpu_solve&#40;
    n &#61; nA,
    m &#61; mA,
    nb &#61; nA,
    c_cpu &#61; c,
    G_cpu &#61; A,
    h_cpu &#61; b,
    mGzero &#61; m &#43; n,
    mGnonnegative &#61; 0,
    socG &#61; Vector&#123;Integer&#125;&#40;&#91;&#93;&#41;,
    rsocG &#61; Vector&#123;Integer&#125;&#40;&#91;&#93;&#41;,
    expG &#61; m,
    dual_expG &#61; 0,
    bl_cpu &#61; bl,
    bu_cpu &#61; bu,
    soc_x &#61; Vector&#123;Integer&#125;&#40;&#91;&#93;&#41;,
    rsoc_x &#61; Vector&#123;Integer&#125;&#40;&#91;&#93;&#41;,
    exp_x &#61; 0,
    dual_exp_x &#61; 0,
    print_freq &#61; 100,
    use_preconditioner &#61; true,
    rescaling_method &#61; :ruiz_pock_chambolle,
    method &#61; :average,
    time_limit &#61; 1000000.0,
    use_adaptive_restart &#61; true,
    use_adaptive_step_size_weight &#61; true,
    use_resolving &#61; true,
    use_accelerated &#61; false,
    use_aggressive &#61; true,
    verbose &#61; 2,
    rel_tol &#61; 1e-6,
    abs_tol &#61; 1e-6,
&#41;;</code></pre>
<div class="page-foot">
    <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> Zhenwei Lin and Zikai Xiong. Last modified: May 24, 2025.
    Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
</div>
</div><!-- CONTENT ENDS HERE -->
    
        



    
    
        <script src="/PDCS/libs/highlight/highlight.min.js"></script>
<script>hljs.highlightAll();hljs.configure({tabReplace: '    '});</script>

    
  </body>
</html>
